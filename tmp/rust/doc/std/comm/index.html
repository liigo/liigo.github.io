<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>std::comm - Rust</title>

    <link href='http://fonts.googleapis.com/css?family=Oswald:700|Inconsolata:400,700'
          rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../../main.css">

    <link rel="shortcut icon" href="http://www.rust-lang.org/favicon.ico" />
</head>
<body>
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    <section class="sidebar">
        
            <a href='../../std/index.html'><img src='http://www.rust-lang.org/logos/rust-logo-128x128-blk-v2.png' alt=''/></a>
        

        <p class='location'><a href='../index.html'>std</a></p><div class='block mod'><h2>Modules</h2><a class='mod ' href='../any/index.html' title='Traits for dynamic typing of any type (through runtime reflection)'>any</a><br/><a class='mod ' href='../ascii/index.html' title='Operations on ASCII strings and characters'>ascii</a><br/><a class='mod ' href='../bool/index.html' title='Operations on boolean values (`bool` type)'>bool</a><br/><a class='mod ' href='../c_str/index.html' title='C-string manipulation and management'>c_str</a><br/><a class='mod ' href='../c_vec/index.html' title='Library to interface with chunks of memory allocated in C.'>c_vec</a><br/><a class='mod ' href='../cast/index.html' title='Unsafe casting functions'>cast</a><br/><a class='mod ' href='../cell/index.html' title='Types dealing with dynamic mutability'>cell</a><br/><a class='mod ' href='../char/index.html' title='Character manipulation (`char` type, Unicode Scalar Value)'>char</a><br/><a class='mod ' href='../clone/index.html' title='The `Clone` trait for types that cannot be 'implicitly copied''>clone</a><br/><a class='mod ' href='../cmp/index.html' title='The `Ord` and `Eq` comparison traits'>cmp</a><br/><a class='mod current' href='../comm/index.html' title='Communication primitives for concurrent tasks'>comm</a><br/><a class='mod ' href='../container/index.html' title='Traits for generic containers (including `Map` and `Set`)'>container</a><br/><a class='mod ' href='../default/index.html' title='The `Default` trait for types which may have meaningful default values'>default</a><br/><a class='mod ' href='../f32/index.html' title='Operations and constants for 32-bits floats (`f32` type)'>f32</a><br/><a class='mod ' href='../f64/index.html' title='Operations and constants for 64-bits floats (`f64` type)'>f64</a><br/><a class='mod ' href='../fmt/index.html' title='Utilities for formatting and printing strings'>fmt</a><br/><a class='mod ' href='../from_str/index.html' title='The `FromStr` trait for types that can be created from strings'>from_str</a><br/><a class='mod ' href='../gc/index.html' title='Task-local garbage-collected boxes'>gc</a><br/><a class='mod ' href='../hash/index.html' title='Generic hashing support.'>hash</a><br/><a class='mod ' href='../i16/index.html' title='Operations and constants for signed 16-bits integers (`i16` type)'>i16</a><br/><a class='mod ' href='../i32/index.html' title='Operations and constants for signed 32-bits integers (`i32` type)'>i32</a><br/><a class='mod ' href='../i64/index.html' title='Operations and constants for signed 64-bits integers (`i64` type)'>i64</a><br/><a class='mod ' href='../i8/index.html' title='Operations and constants for signed 8-bits integers (`i8` type)'>i8</a><br/><a class='mod ' href='../int/index.html' title='Operations and constants for architecture-sized signed integers (`int` type)'>int</a><br/><a class='mod ' href='../intrinsics/index.html' title='rustc compiler intrinsics.'>intrinsics</a><br/><a class='mod ' href='../io/index.html' title='I/O, including files, networking, timers, and processes'>io</a><br/><a class='mod ' href='../iter/index.html' title='Composable external iterators'>iter</a><br/><a class='mod ' href='../kinds/index.html' title='Primitive traits representing basic 'kinds' of types'>kinds</a><br/><a class='mod ' href='../libc/index.html' title='Bindings for the C standard library and other platform libraries'>libc</a><br/><a class='mod ' href='../local_data/index.html' title='Task local data management'>local_data</a><br/><a class='mod ' href='../macros/index.html' title='Standard library macros'>macros</a><br/><a class='mod ' href='../managed/index.html' title='Operations on managed box types'>managed</a><br/><a class='mod ' href='../mem/index.html' title='Basic functions for dealing with memory'>mem</a><br/><a class='mod ' href='../num/index.html' title='Numeric traits and functions for generic mathematics'>num</a><br/><a class='mod ' href='../ops/index.html' title=' Traits representing built-in operators, useful for overloading'>ops</a><br/><a class='mod ' href='../option/index.html' title='Optionally nullable values (`Option` type)'>option</a><br/><a class='mod ' href='../os/index.html' title='Higher-level interfaces to libc::* functions and operating system services.'>os</a><br/><a class='mod ' href='../owned/index.html' title='Operations on unique pointer types'>owned</a><br/><a class='mod ' href='../path/index.html' title='Cross-platform path support'>path</a><br/><a class='mod ' href='../prelude/index.html' title='The standard module imported by default into all Rust modules'>prelude</a><br/><a class='mod ' href='../ptr/index.html' title='Unsafe pointer utility functions'>ptr</a><br/><a class='mod ' href='../raw/index.html' title='Contains struct definitions for the layout of compiler built-in types.'>raw</a><br/><a class='mod ' href='../rc/index.html' title='Task-local reference-counted boxes (`Rc` type)'>rc</a><br/><a class='mod ' href='../reflect/index.html' title='Runtime type reflection'>reflect</a><br/><a class='mod ' href='../repr/index.html' title='More runtime type reflection'>repr</a><br/><a class='mod ' href='../result/index.html' title='Signaling success or failure states (`Result` type)'>result</a><br/><a class='mod ' href='../rt/index.html' title='Runtime services, including the task scheduler and I/O dispatcher'>rt</a><br/><a class='mod ' href='../str/index.html' title='Unicode string manipulation (`str` type)'>str</a><br/><a class='mod ' href='../sync/index.html' title='Useful synchronization primitives'>sync</a><br/><a class='mod ' href='../task/index.html' title='Utilities for managing and scheduling tasks'>task</a><br/><a class='mod ' href='../to_str/index.html' title='The `ToStr` trait for converting to strings'>to_str</a><br/><a class='mod ' href='../tuple/index.html' title='Operations on tuples'>tuple</a><br/><a class='mod ' href='../u16/index.html' title='Operations and constants for unsigned 16-bits integers (`u16` type)'>u16</a><br/><a class='mod ' href='../u32/index.html' title='Operations and constants for unsigned 32-bits integers (`u32` type)'>u32</a><br/><a class='mod ' href='../u64/index.html' title='Operations and constants for unsigned 64-bits integer (`u64` type)'>u64</a><br/><a class='mod ' href='../u8/index.html' title='Operations and constants for unsigned 8-bits integers (`u8` type)'>u8</a><br/><a class='mod ' href='../uint/index.html' title='Operations and constants for architecture-sized unsigned integers (`uint` type)'>uint</a><br/><a class='mod ' href='../unit/index.html' title='Functions for the unit type.'>unit</a><br/><a class='mod ' href='../vec/index.html' title='Utilities for vector manipulation'>vec</a><br/><a class='mod ' href='../vec_ng/index.html' title=''>vec_ng</a><br/></div>
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <button class="do-search">Search</button>
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Search documentation..."
                       type="search" />
            </div>
        </form>
    </nav>

    <section id='main' class="content mod"><a class='source'
                              href='../../src/std/MinGW/msys/1.0/home/LIIGO/rust/rust/src/libstd/lib.rs.html#165'>[src]</a><h1 class='fqn'>Module <a href='../index.html'>std</a>::<a class='mod' href=''>comm</a></h1><div class='docblock'><p>Communication primitives for concurrent tasks</p>

<p>Rust makes it very difficult to share data among tasks to prevent race
conditions and to improve parallelism, but there is often a need for
communication between concurrent tasks. The primitives defined in this
module are the building blocks for synchronization in rust.</p>

<p>This module provides message-based communication over channels, concretely
defined as two types:</p>

<ul>
<li><code>Sender</code></li>
<li><code>Receiver</code></li>
</ul>

<p>A <code>Sender</code> is used to send data to a <code>Receiver</code>. A <code>Sender</code> is clone-able
such that many tasks can send simultaneously to one receiver. These
channels are <em>task blocking</em>, not <em>thread blocking</em>. This means that if one
task is blocked on a channel, other tasks can continue to make progress.</p>

<p>Rust channels can be used as if they have an infinite internal buffer. What
this means is that the <code>send</code> operation will never block. <code>Receiver</code>s, on
the other hand, will block the task if there is no data to be received.</p>

<h2 id="failure-propagation" class='section-link'><a
                           href="#failure-propagation">Failure Propagation</a></h2>
<p>In addition to being a core primitive for communicating in rust, channels
are the points at which failure is propagated among tasks.  Whenever the one
half of channel is closed, the other half will have its next operation
<code>fail!</code>. The purpose of this is to allow propagation of failure among tasks
that are linked to one another via channels.</p>

<p>There are methods on both of <code>Sender</code> and <code>Receiver</code> to perform their
respective operations without failing, however.</p>

<h2 id="outside-the-runtime" class='section-link'><a
                           href="#outside-the-runtime">Outside the Runtime</a></h2>
<p>All channels and ports work seamlessly inside and outside of the rust
runtime. This means that code may use channels to communicate information
inside and outside of the runtime. For example, if rust were embedded as an
FFI module in another application, the rust runtime would probably be
running in its own external thread pool. Channels created can communicate
from the native application threads to the rust threads through the use of
native mutexes and condition variables.</p>

<p>What this means is that if a native thread is using a channel, execution
will be blocked accordingly by blocking the OS thread.</p>

<h1 id="example" class='section-link'><a
                           href="#example">Example</a></h1><pre class='rust '>
<span class='comment'>// Create a simple streaming channel
</span><span class='kw'>let</span> (<span class='ident'>tx</span>, <span class='ident'>rx</span>) <span class='op'>=</span> <span class='ident'>channel</span>();
<span class='ident'>spawn</span>(<span class='kw'>proc</span>() {
    <span class='ident'>tx</span>.<span class='ident'>send</span>(<span class='number'>10</span>);
});
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>rx</span>.<span class='ident'>recv</span>(), <span class='number'>10</span>);<span class='comment'>

// Create a shared channel which can be sent along from many tasks
</span><span class='kw'>let</span> (<span class='ident'>tx</span>, <span class='ident'>rx</span>) <span class='op'>=</span> <span class='ident'>channel</span>();
<span class='kw'>for</span> <span class='ident'>i</span> <span class='kw'>in</span> <span class='ident'>range</span>(<span class='number'>0</span>, <span class='number'>10</span>) {
    <span class='kw'>let</span> <span class='ident'>tx</span> <span class='op'>=</span> <span class='ident'>tx</span>.<span class='ident'>clone</span>();
    <span class='ident'>spawn</span>(<span class='kw'>proc</span>() {
        <span class='ident'>tx</span>.<span class='ident'>send</span>(<span class='ident'>i</span>);
    })
}

<span class='kw'>for</span> _ <span class='kw'>in</span> <span class='ident'>range</span>(<span class='number'>0</span>, <span class='number'>10</span>) {
    <span class='kw'>let</span> <span class='ident'>j</span> <span class='op'>=</span> <span class='ident'>rx</span>.<span class='ident'>recv</span>();
    <span class='macro'>assert</span><span class='macro'>!</span>(<span class='number'>0</span> <span class='op'>&lt;=</span> <span class='ident'>j</span> <span class='op'>&amp;&amp;</span> <span class='ident'>j</span> <span class='op'>&lt;</span> <span class='number'>10</span>);
}<span class='comment'>

// The call to recv() will fail!() because the channel has already hung
// up (or been deallocated)
</span><span class='kw'>let</span> (<span class='ident'>tx</span>, <span class='ident'>rx</span>) <span class='op'>=</span> <span class='ident'>channel</span>::<span class='op'>&lt;</span><span class='ident'>int</span><span class='op'>&gt;</span>();
<span class='ident'>drop</span>(<span class='ident'>tx</span>);
<span class='ident'>rx</span>.<span class='ident'>recv</span>();
</pre>
</div><h2 id='structs' class='section-link'><a href="#structs">Structs</a></h2>
<table>
                    <tr>
                        <td><a class='struct' href='struct.Handle.html'
                               title='std::comm::Handle'>Handle</a></td>
                        <td class='docblock short'><p>A handle to a receiver which is currently a member of a <code>Select</code> set of
receivers.  This handle is used to keep the receiver in the set as well as
interact with the underlying receiver.</p>
</td>
                    </tr>
                
                    <tr>
                        <td><a class='struct' href='struct.Messages.html'
                               title='std::comm::Messages'>Messages</a></td>
                        <td class='docblock short'><p>An iterator over messages on a receiver, this iterator will block
whenever <code>next</code> is called, waiting for a new message, and <code>None</code> will be
returned when the corresponding channel has hung up.</p>
</td>
                    </tr>
                
                    <tr>
                        <td><a class='struct' href='struct.Receiver.html'
                               title='std::comm::Receiver'>Receiver</a></td>
                        <td class='docblock short'><p>The receiving-half of Rust&#39;s channel type. This half can only be owned by
one task</p>
</td>
                    </tr>
                
                    <tr>
                        <td><a class='struct' href='struct.Select.html'
                               title='std::comm::Select'>Select</a></td>
                        <td class='docblock short'><p>The &quot;receiver set&quot; of the select interface. This structure is used to manage
a set of receivers which are being selected over.</p>
</td>
                    </tr>
                
                    <tr>
                        <td><a class='struct' href='struct.Sender.html'
                               title='std::comm::Sender'>Sender</a></td>
                        <td class='docblock short'><p>The sending-half of Rust&#39;s channel type. This half can only be owned by one
task</p>
</td>
                    </tr>
                </table><h2 id='enums' class='section-link'><a href="#enums">Enums</a></h2>
<table>
                    <tr>
                        <td><a class='enum' href='enum.TryRecvResult.html'
                               title='std::comm::TryRecvResult'>TryRecvResult</a></td>
                        <td class='docblock short'><p>This enumeration is the list of the possible reasons that try_recv could not
return data when called.</p>
</td>
                    </tr>
                </table><h2 id='functions' class='section-link'><a href="#functions">Functions</a></h2>
<table>
                    <tr>
                        <td><a class='fn' href='fn.channel.html'
                               title='std::comm::channel'>channel</a></td>
                        <td class='docblock short'><p>Creates a new channel, returning the sender/receiver halves. All data sent
on the sender will become available on the receiver. See the documentation
of <code>Receiver</code> and <code>Sender</code> to see what&#39;s possible with them.</p>
</td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div class="shortcuts">
            <h1>Keyboard shortcuts</h1>
            <dl>
                <dt>?</dt>
                <dd>Show this help dialog</dd>
                <dt>S</dt>
                <dd>Focus the search field</dd>
                <dt>&uarr;</dt>
                <dd>Move up in search results</dd>
                <dt>&darr;</dt>
                <dd>Move down in search results</dd>
                <dt>&#9166;</dt>
                <dd>Go to active search result</dd>
            </dl>
        </div>
        <div class="infos">
            <h1>Search tricks</h1>
            <p>
                Prefix searches with a type followed by a colon (e.g.
                <code>fn:</code>) to restrict the search to a given type.
            </p>
            <p>
                Accepted types are: <code>fn</code>, <code>mod</code>,
                <code>struct</code> (or <code>str</code>), <code>enum</code>,
                <code>trait</code>, <code>typedef</code> (or
                <code>tdef</code>).
            </p>
        </div>
    </div>

    <script>
        var rootPath = "../../";
        var currentCrate = "std";
    </script>
    <script src="../../jquery.js"></script>
    <script src="../../main.js"></script>
    <script async src="../../search-index.js"></script>
</body>
</html>
